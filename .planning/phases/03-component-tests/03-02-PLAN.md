---
phase: 03-component-tests
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - __tests__/components/CharacterDetail.test.tsx
  - __tests__/components/RankingBoard.test.tsx
  - __tests__/components/GrowthCalculatorPage.test.tsx
  - __tests__/components/Modal.test.tsx
autonomous: true

must_haves:
  truths:
    - "CharacterDetail 컴포넌트가 캐릭터 정보를 올바르게 렌더링한다"
    - "RankingBoard 컴포넌트가 랭킹 목록을 표시하고 닉네임 등록을 처리한다"
    - "GrowthCalculatorPage 컴포넌트가 재료 입력과 캐릭터 계획을 관리한다"
    - "Modal 컴포넌트들이 열기/닫기 동작을 올바르게 처리한다"
  artifacts:
    - path: "__tests__/components/CharacterDetail.test.tsx"
      provides: "CharacterDetail 렌더링 테스트"
      min_lines: 50
    - path: "__tests__/components/RankingBoard.test.tsx"
      provides: "RankingBoard 렌더링 및 상호작용 테스트"
      min_lines: 60
    - path: "__tests__/components/GrowthCalculatorPage.test.tsx"
      provides: "GrowthCalculatorPage 렌더링 및 상호작용 테스트"
      min_lines: 60
    - path: "__tests__/components/Modal.test.tsx"
      provides: "ConfirmModal, ModalProvider 테스트"
      min_lines: 40
  key_links:
    - from: "__tests__/components/CharacterDetail.test.tsx"
      to: "components/character/CharacterDetail.tsx"
      via: "render with character prop"
      pattern: "render.*CharacterDetail"
    - from: "__tests__/components/RankingBoard.test.tsx"
      to: "components/quiz/RankingBoard.tsx"
      via: "render with result prop"
      pattern: "render.*RankingBoard"
    - from: "__tests__/components/Modal.test.tsx"
      to: "components/modals/ConfirmModal.tsx"
      via: "render with isOpen prop"
      pattern: "render.*ConfirmModal"
---

<objective>
CharacterDetail, RankingBoard, GrowthCalculatorPage, Modal 보조 컴포넌트의 렌더링 및 상호작용 테스트를 작성한다.

Purpose: 캐릭터 상세, 랭킹, 육성 계산기, 모달 등 주요 UI 컴포넌트가 올바르게 동작함을 검증
Output: CharacterDetail.test.tsx, RankingBoard.test.tsx, GrowthCalculatorPage.test.tsx, Modal.test.tsx 테스트 파일
</objective>

<execution_context>
@/Users/lyvakim/.claude/get-shit-done/workflows/execute-plan.md
@/Users/lyvakim/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Target components
@components/character/CharacterDetail.tsx
@components/quiz/RankingBoard.tsx
@components/growth_calculator/GrowthCalculatorPage.tsx
@components/modals/ConfirmModal.tsx
@components/etc/ModalProvider.tsx

# Test infrastructure
@jest.config.js
@jest.setup.js
@__tests__/fixtures/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: CharacterDetail 컴포넌트 테스트</name>
  <files>__tests__/components/CharacterDetail.test.tsx</files>
  <action>
CharacterDetail 컴포넌트의 렌더링 테스트를 작성한다.

테스트 케이스:
1. 기본 렌더링 - 캐릭터 이름, 레어리티, 속성이 표시되는지 확인
2. 가이드 정보 표시 - character_guide 데이터가 있는 캐릭터의 가이드 정보 표시 확인
3. 추천팀 표시 - recommend_team 데이터가 있는 캐릭터의 추천팀 표시 확인
4. 육성 재료 표시 - 레조넌스/유포리아 재료가 있는 캐릭터의 육성 탭 표시 확인
5. 버전 정보 - getDisplayVersion 함수로 포맷된 버전 표시 확인

모킹 전략:
- next/image: jest.mock으로 img 태그로 대체
- next/link: jest.mock으로 a 태그로 대체
- @/lib/cdn: jest.mock으로 고정 URL 반환

실제 캐릭터 데이터 사용 (charactersByRarity에서 선택)

한국어 테스트 설명 패턴 유지
  </action>
  <verify>
npm run test:unit -- --testPathPattern="CharacterDetail" --verbose
모든 테스트가 PASS해야 함
  </verify>
  <done>
CharacterDetail 컴포넌트가 캐릭터 정보, 가이드, 추천팀, 육성 재료를 props에 따라 올바르게 렌더링함이 5개 이상의 테스트로 검증됨
  </done>
</task>

<task type="auto">
  <name>Task 2: RankingBoard 및 GrowthCalculatorPage 컴포넌트 테스트</name>
  <files>
__tests__/components/RankingBoard.test.tsx
__tests__/components/GrowthCalculatorPage.test.tsx
  </files>
  <action>
RankingBoard와 GrowthCalculatorPage 컴포넌트의 렌더링 및 상호작용 테스트를 작성한다.

RankingBoard 테스트 케이스:
1. 기본 렌더링 - 결과 점수, 정답률이 표시되는지 확인
2. 랭킹 목록 표시 - Firebase에서 불러온 랭킹 목록이 표시되는지 확인
3. 닉네임 입력 - 닉네임 입력 필드가 동작하는지 확인
4. 등록 버튼 - 닉네임 입력 후 등록 버튼 클릭 시 Firebase 저장 호출 확인
5. 뷰 모드 전환 - rankings/register 뷰 모드 전환 확인

GrowthCalculatorPage 테스트 케이스:
1. 기본 렌더링 - 재료 입력 버튼, 캐릭터 추가 버튼이 표시되는지 확인
2. 재료 입력 모달 열기 - 재료 입력 버튼 클릭 시 모달이 열리는지 확인
3. 캐릭터 선택 모달 열기 - 캐릭터 추가 버튼 클릭 시 모달이 열리는지 확인
4. localStorage 연동 - 초기 로드 시 저장된 데이터 불러오기 확인
5. 재료 부족 표시 - 필요 재료 대비 보유 재료 부족 시 표시 확인

모킹 전략:
- @/lib/firebase/firestore: jest.mock으로 saveRanking, getRankingsByQuizSet 모킹
- localStorage: jest.spyOn으로 getItem, setItem 모킹
- next/image: jest.mock으로 img 태그로 대체
- @/lib/posthog: jest.mock으로 analytics 모킹
- uuid: jest.mock으로 고정값 반환

한국어 테스트 설명 패턴 유지
  </action>
  <verify>
npm run test:unit -- --testPathPattern="RankingBoard|GrowthCalculator" --verbose
모든 테스트가 PASS해야 함
  </verify>
  <done>
RankingBoard가 랭킹 표시 및 닉네임 등록을 처리하고, GrowthCalculatorPage가 재료/캐릭터 관리를 처리함이 각 5개 이상의 테스트로 검증됨
  </done>
</task>

<task type="auto">
  <name>Task 3: Modal 컴포넌트 테스트</name>
  <files>__tests__/components/Modal.test.tsx</files>
  <action>
ConfirmModal과 ModalProvider 컴포넌트의 테스트를 작성한다.

ConfirmModal 테스트 케이스:
1. isOpen=true일 때 children이 렌더링되는지 확인
2. isOpen=false일 때 children이 렌더링되지 않는지 확인
3. 모달 외부 클릭 시 onClose가 호출되는지 확인
4. Enter 키 debounce 동작 - 모달 닫힌 직후 Enter 키 무시 확인

ModalProvider 테스트 케이스:
1. 기본 렌더링 - children이 렌더링되는지 확인
2. useModal hook 동작 - openModal("material") 호출 시 CardInfoModal이 열리는지 확인
3. closeModal 동작 - closeModal 호출 시 모달이 닫히는지 확인
4. ModalProvider 외부에서 useModal 호출 시 에러 발생 확인

모킹 전략:
- @/components/ui/dialog: 실제 Radix UI Dialog 사용 (모킹 불필요)
- next/image: jest.mock으로 img 태그로 대체 (CardInfoModal 내부용)

한국어 테스트 설명 패턴 유지
  </action>
  <verify>
npm run test:unit -- --testPathPattern="Modal" --verbose
모든 테스트가 PASS해야 함
  </verify>
  <done>
ConfirmModal과 ModalProvider가 열기/닫기/children 렌더링을 올바르게 처리함이 8개 이상의 테스트로 검증됨
  </done>
</task>

</tasks>

<verification>
npm run test:unit -- --testPathPattern="CharacterDetail|RankingBoard|GrowthCalculator|Modal" --verbose
모든 보조 컴포넌트 테스트가 PASS해야 함
</verification>

<success_criteria>
1. CharacterDetail.test.tsx에서 5개 이상의 테스트가 통과
2. RankingBoard.test.tsx에서 5개 이상의 테스트가 통과
3. GrowthCalculatorPage.test.tsx에서 5개 이상의 테스트가 통과
4. Modal.test.tsx에서 8개 이상의 테스트가 통과
5. npm run test:unit 실행 시 모든 테스트 통과
</success_criteria>

<output>
After completion, create `.planning/phases/03-component-tests/03-02-SUMMARY.md`
</output>
