---
phase: 04-e2e-tests
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - __tests__/e2e/character.spec.ts
  - __tests__/e2e/navigation.spec.ts
autonomous: true

must_haves:
  truths:
    - "사용자가 캐릭터 목록에서 캐릭터를 검색하고 상세 페이지로 이동할 수 있다"
    - "캐릭터 상세 페이지에서 정보와 스킨 탭이 표시된다"
    - "홈페이지에서 각 섹션 링크를 통해 해당 페이지로 이동할 수 있다"
    - "테마 토글 버튼 클릭 시 다크/라이트 모드가 전환된다"
  artifacts:
    - path: "__tests__/e2e/character.spec.ts"
      provides: "캐릭터 조회 E2E 플로우 테스트"
      min_lines: 50
    - path: "__tests__/e2e/navigation.spec.ts"
      provides: "네비게이션 및 테마 전환 E2E 테스트"
      min_lines: 50
  key_links:
    - from: "__tests__/e2e/character.spec.ts"
      to: "/character"
      via: "page.goto and navigation"
      pattern: "page\\.goto.*character"
    - from: "__tests__/e2e/navigation.spec.ts"
      to: "/"
      via: "page.goto and link clicks"
      pattern: "page\\.goto.*/"
---

<objective>
캐릭터 조회 플로우와 네비게이션/테마 전환 E2E 테스트를 작성한다.

Purpose: 브라우징 기능(캐릭터 검색, 페이지 이동, 테마 전환)이 실제 브라우저에서 동작함을 검증
Output: character.spec.ts, navigation.spec.ts E2E 테스트 파일
</objective>

<execution_context>
@/Users/lyvakim/.claude/get-shit-done/workflows/execute-plan.md
@/Users/lyvakim/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-infrastructure/01-01-SUMMARY.md

# E2E infrastructure
@playwright.config.ts
@__tests__/e2e/smoke.spec.ts

# Target pages
@app/page.tsx
@app/character/page.tsx
@app/character/[id]/page.tsx
@app/skin/page.tsx

# Key components
@components/character/CharacterList.tsx
@components/etc/ThemeToggle.tsx
@components/home/HomePage.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: 캐릭터 조회 E2E 테스트</name>
  <files>__tests__/e2e/character.spec.ts</files>
  <action>
캐릭터 조회 전체 플로우를 E2E 테스트로 작성한다.

테스트 케이스:
1. 캐릭터 목록 페이지 로드 - /character 페이지에서 캐릭터 그리드가 표시되는지 확인
2. 캐릭터 검색 - 검색창에 캐릭터 이름 입력 후 필터링되는지 확인 (예: "버틴" 검색)
3. 타입 필터 - 역할 타입(공격/보조/밸런스/방어) 선택 시 필터링되는지 확인
4. 속성 필터 - 영감 속성(야수/천체/암석 등) 선택 시 필터링되는지 확인
5. 캐릭터 상세 이동 - 캐릭터 카드 클릭 시 /character/[id] 페이지로 이동하는지 확인
6. 상세 페이지 정보 표시 - 캐릭터 이름, 등급, 정보가 표시되는지 확인
7. 탭 전환 - 상세 페이지에서 다른 탭(공명, 의지 등)으로 전환되는지 확인

Playwright 패턴:
- page.goto('/character')로 캐릭터 목록 페이지 이동
- page.locator('input[type="text"]')로 검색창 선택
- page.fill()로 텍스트 입력
- page.waitForURL(/character\/\d+/)로 상세 페이지 이동 확인
- page.locator('[role="tab"]')로 탭 선택

주의사항:
- 캐릭터 데이터가 많으므로 첫 번째 또는 특정 캐릭터만 테스트
- 이미지 로딩 시간 고려하여 적절한 timeout 설정
- URL 파라미터 변경 (검색어, 필터)도 확인
  </action>
  <verify>
npx playwright test character.spec.ts --reporter=list
모든 테스트가 PASS해야 함
  </verify>
  <done>
캐릭터 조회 플로우(목록 로드 -> 검색/필터 -> 상세 이동 -> 탭 전환)가 7개 이상의 E2E 테스트로 검증됨
  </done>
</task>

<task type="auto">
  <name>Task 2: 네비게이션 및 테마 전환 E2E 테스트</name>
  <files>__tests__/e2e/navigation.spec.ts</files>
  <action>
홈페이지 네비게이션과 테마 전환 E2E 테스트를 작성한다.

테스트 케이스:
1. 홈페이지 로드 - 메인 페이지에서 3개 섹션(놀이터, 도서관, 가이드)이 표시되는지 확인
2. 놀이터 링크 - "가챠 시뮬레이터" 링크 클릭 시 /gacha_simulator로 이동하는지 확인
3. 도서관 링크 - "캐릭터 가이드" 링크 클릭 시 /character로 이동하는지 확인
4. 가이드 링크 - "뉴비 가이드" 또는 다른 가이드 링크 클릭 시 해당 페이지로 이동하는지 확인
5. 테마 토글 - 테마 토글 버튼 클릭 시 dark/light 모드가 전환되는지 확인
6. 테마 지속성 - 테마 변경 후 페이지 새로고침해도 테마가 유지되는지 확인
7. 모바일 네비게이션 - 모바일 뷰포트에서 햄버거 메뉴가 동작하는지 확인 (optional)

Playwright 패턴:
- page.goto('/')로 홈페이지 이동
- page.locator('a[href="/gacha_simulator"]')로 링크 선택
- page.click()으로 클릭
- page.waitForURL()로 이동 확인
- 테마 확인: document.documentElement.classList 또는 data-theme 속성 확인
- page.evaluate()로 DOM 클래스 확인

테마 토글 버튼 특징:
- position: fixed, right-4 top-4 위치
- aria-label: "라이트 모드로 전환" 또는 "다크 모드로 전환"
- 클릭 시 html 요소의 class에 "dark" 추가/제거

주의사항:
- 테마는 next-themes 사용, localStorage에 "theme" 키로 저장
- 배경 이미지 로딩 대기 필요 (HomePageSkeleton -> HomePage 전환)
- 일부 링크는 모달을 열 수 있음 (modalType 있는 항목)
  </action>
  <verify>
npx playwright test navigation.spec.ts --reporter=list
모든 테스트가 PASS해야 함
  </verify>
  <done>
네비게이션 플로우(홈 -> 각 섹션 이동)와 테마 전환(다크/라이트 전환 및 지속성)이 7개 이상의 E2E 테스트로 검증됨
  </done>
</task>

</tasks>

<verification>
npx playwright test character.spec.ts navigation.spec.ts --reporter=list
모든 E2E 테스트가 PASS해야 함
</verification>

<success_criteria>
1. character.spec.ts에서 7개 이상의 테스트가 통과
2. navigation.spec.ts에서 7개 이상의 테스트가 통과
3. 각 테스트가 실제 브라우저에서 사용자 플로우를 검증
4. npm run test:e2e 실행 시 모든 E2E 테스트 통과
</success_criteria>

<output>
After completion, create `.planning/phases/04-e2e-tests/04-02-SUMMARY.md`
</output>
